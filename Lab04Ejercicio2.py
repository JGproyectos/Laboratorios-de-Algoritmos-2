import random
import time
global comparacion
comparacion = 0
global logicas
logicas = 0
global asignacion
asignacion = 0
global aritmeticas
aritmeticas =0
def QuickSort(arreglo,primer,ultimo):
  global aritmeticas
  aritmeticas = aritmeticas + 2
  if primer < ultimo:
    global comparacion
    comparacion = comparacion + 1
    global asignacion
    asignacion = asignacion + 1
    q = particionRandomizada(arreglo,primer,ultimo)

    QuickSort(arreglo,primer,q - 1)
    QuickSort(arreglo,q + 1,ultimo)


def particionRandomizada(arreglo,primer,ultimo):
  global asignacion

  asignacion = asignacion + 1 
  i = random.randrange(primer,ultimo)
  asignacion = asignacion + 1
  arreglo[i],arreglo[ultimo] = arreglo[ultimo],arreglo[i]
  q = particion(arreglo,primer,ultimo)

  return q

def particion(arreglo,primer,ultimo):
  global asignacion
  global comparacion
  global logicas
  global aritmeticas

  asignacion = asignacion + 1
  x = arreglo[primer]
  asignacion = asignacion + 2
  izquierdo = primer + 1
  derecho = ultimo

  while True:
 
    comparacion = comparacion + 1
    logicas = logicas + 1 
    while izquierdo <= derecho and arreglo[izquierdo] <= x:
      
      asignacion = asignacion + 1
      aritmeticas = aritmeticas + 1
      izquierdo = izquierdo + 1

    comparacion = comparacion + 1
    logicas = logicas + 1 
    while arreglo[derecho] >= x and derecho >= izquierdo:
      derecho = derecho - 1
      asignacion = asignacion + 1
      aritmeticas = aritmeticas + 1

    if derecho < izquierdo:
      break

    else:
      arreglo[izquierdo],arreglo[derecho] = arreglo[derecho],arreglo[izquierdo]
      asignacion = asignacion +  1

  arreglo[primer],arreglo[derecho] = arreglo[derecho],arreglo[primer]
  asignacion = asignacion + 1

  return derecho

total = logicas + asignacion + comparacion + aritmeticas
caso1 = [9602, 7540, 959, 8000, 7596, 841, 7534, 7931, 3437, 6871]
caso2 = [2593, 8781, 3764, 4117, 687, 8514, 7028, 2660, 171, 6403, 6760, 7301, 4710, 7160, 9065, 9590, 134, 2896, 3158, 8077, 1416, 7399, 2338, 6076, 8197, 9782, 9737, 521, 5471, 9358, 7751, 7582]
caso3 = [1942, 8728, 9150, 5444, 653, 6792, 9925, 5495, 600, 8960, 1439, 292, 2456, 103, 4685, 8398, 8734, 4453, 1069, 6395, 2965, 5859, 5166, 7787, 209, 7100, 5658, 1883, 8441, 5646, 2464, 9461, 693, 8706, 4974, 4673, 725, 4867, 187, 2310, 6275, 2065, 1107, 60, 728, 1331, 6528, 8405, 4463, 8495, 119, 952, 5611, 2293, 355, 2018, 5634, 8463, 9827, 7366, 1053, 3787, 6084, 2839, 7183, 508, 9479, 7510, 1568, 9943, 4215, 9345, 554, 2812, 7565, 593, 9446, 1008, 7903, 2777, 21, 1248, 1647, 147, 6865, 3418, 9123, 1635, 7561, 841, 9144, 2244, 5749, 5881, 3089, 695, 3023, 7729, 1291, 9513]
caso4 = [8093, 1939, 1949, 6724, 295, 7596, 9079, 4484, 3749, 4273, 727, 1614, 139, 2984, 9041, 9019, 5753, 6960, 72, 8602, 6176, 3543, 4948, 2521, 622, 3118, 3661, 2782, 1799, 9479, 488, 5991, 5057, 6217, 8772, 11, 4158, 5461, 6956, 3299, 8978, 8225, 6260, 329, 6804, 6843, 6128, 269, 3644, 1299, 9799, 8902, 2638, 3681, 390, 7568, 680, 3537, 5388, 3975, 1374, 1255, 3387, 4906, 4042, 6354, 7809, 9327, 59, 1175, 5543, 8383, 3656, 7555, 3029, 5796, 819, 597, 6317, 111, 7348, 6603, 4899, 7404, 4871, 180, 7226, 6036, 1851, 1913, 7723, 8919, 1128, 6378, 825, 6065, 178, 842, 8026, 9812, 9260, 593, 3298, 1104, 7488, 1680, 9958, 4815, 9537, 2120, 6195, 4578, 6428, 6158, 9273, 4902, 2102, 4343, 8122, 4047, 1654, 8719, 5074, 203, 8193, 9428, 6079, 9419, 1840, 9427, 2509, 228, 450, 4791, 5951, 1984, 845, 3066, 7965, 9190, 2432, 5300, 6965, 7791, 8377, 2996, 4112, 4968, 6575, 7623, 1847, 9927, 8046, 8721, 7485, 1123, 3734, 1214, 8088, 6312, 4940, 1996, 650, 6204, 293, 8945, 3483, 6192, 1052, 6012, 6863, 1397, 748, 4110, 555, 2391, 8119, 6243, 1978, 2574, 3701, 1235, 6283, 9376, 2200, 7269, 2000, 8522, 5447, 8817, 7764, 6690, 8886, 7733, 9839, 490, 16, 371, 4300, 6096, 917, 614, 7495, 2368, 5255, 260, 9785, 6834, 9617, 8781, 2783, 6709, 7050, 6190, 9028, 732, 305, 7401, 4447, 702, 7836, 816, 3934, 3521, 5700, 5636, 4250, 9589, 4854, 7560, 2563, 2674, 5678, 6118, 2736, 5880, 920, 3518, 6512, 1322, 22, 7853, 8052, 4228, 1015, 1424, 4142, 2705, 6694, 5113, 5838, 6588, 3590, 7297, 3878, 6554, 5649, 5403, 525, 1677, 1694, 8058, 8070, 8435, 5010, 2512, 3910, 9251, 8925, 2203, 306, 9493, 4190, 2031, 5503, 2732, 8230, 83, 2990, 9142, 710, 6819, 1042, 1272, 2587, 7419, 743, 8129, 1346, 9137, 3699, 3857, 2881, 6696, 3231, 7900, 7058, 5512, 5825, 5763, 247, 2068, 9774, 3667, 1546, 2, 7707, 924, 6552, 3740, 4429, 7875, 7437, 1283, 6655, 8609
]
caso5 = [1599, 244, 2270, 9023, 2540, 8159, 6413, 5501, 6099, 1896, 1558, 4105, 5886, 2488, 6344, 4726, 5016, 3147, 1201, 7635, 6435, 40, 6017, 8888, 4223, 4876, 288, 294, 6784, 1787, 7936, 8805, 3491, 676, 2050, 7293, 6613, 5950, 8508, 6632, 5142, 916, 7428, 7417, 9113, 7070, 6090, 7754, 9998, 990, 4817, 2775, 1790, 7619, 2047, 2519, 9921, 7335, 1345, 9358, 6922, 5482, 7830, 2168, 7557, 856, 984, 9691, 4922, 216, 377, 535, 5224, 930, 796, 871, 8370, 7764, 9218, 2152, 4856, 9399, 7962, 261, 7871, 3924, 5005, 3404, 3456, 2969, 4673, 4224, 6292, 667, 7606, 8332, 9835, 6337, 7248, 7602, 7683, 2936, 7908, 1716, 8818, 4254, 2802, 8226, 6789, 8989, 7987, 3715, 9855, 686, 6754, 1064, 9380, 1729, 8312, 604, 2544, 2864, 9994, 157, 9574, 5561, 7841, 952, 6683, 9260, 1024, 2496, 404, 337, 6543, 184, 6805, 777, 4210, 1032, 9931, 117, 434, 7016, 2078, 9729, 5158, 8691, 501, 5496, 6936, 4448, 4873, 5573, 1548, 12, 5947, 2623, 5998, 4338, 6691, 832, 9252, 9376, 2779, 5116, 3134, 1485, 1080, 616, 6940, 7257, 1234, 3114, 4296, 6145, 7795, 6509, 1096, 9099, 8012, 8355, 3072, 6794, 1826, 6540, 3301, 803, 7096, 6365, 1060, 2951, 8498, 1306, 6727, 774, 7480, 8195, 7474, 42, 5603, 727, 9558, 3439, 7956, 694, 747, 893, 9325, 525, 4462, 6579, 1836, 1890, 9926, 1674, 2892, 3225, 225, 6457, 523, 7943, 9159, 1991, 4068, 7400, 480, 194, 1620, 8812, 6361, 477, 3236, 944, 6173, 3381, 5757, 9203, 5766, 9513, 2557, 1061, 1408, 9625, 3200, 1986, 7747, 9771, 5310, 9048, 243, 3, 976, 518, 5242, 97, 690, 3290, 8865, 3640, 1650, 8252, 8481, 2764, 2723, 459, 4148, 7703, 8169, 3205, 7653, 1465, 3137, 699, 6005, 5984, 533, 2930, 4913, 694, 9109, 7774, 5753, 1104, 7749, 680, 8676, 643, 6580, 6591, 2858, 6006, 7714, 2235, 187, 6052, 8214, 7036, 2755, 1464, 8519, 6998, 2045, 8198, 9902, 8661, 758, 1664, 275, 2377, 5897, 924, 3227, 7137, 5409, 8819, 2035, 1446, 313, 7723, 4, 4408, 261, 8482, 2056, 4815, 1092, 8391, 2595, 9384, 5505, 5771, 67, 7832, 6018, 5320, 33, 5264, 7988, 2695, 6226, 5190, 167, 9442, 2769, 152, 8540, 4685, 439, 3296, 4189, 7435, 1516, 2886, 6327, 6681, 2176, 6273, 5786, 6772, 8855, 8892, 5607, 221, 7534, 3543, 1863, 8087, 6408, 4222, 757, 7144, 9847, 7301, 3647, 527, 310, 6759, 9774, 2412, 1169, 7220, 6710, 5382, 366, 6901, 6641, 2840, 2618, 3875, 2545, 7586, 5377, 4044, 8480, 6341, 6804, 3078, 3065, 8753, 2553, 7191, 1275, 9350, 3562, 9087, 7506, 5213, 3070, 1994, 6864, 9191, 368, 2654, 6876, 553, 6433, 5419, 864, 1210, 9986, 2532, 5239, 7691, 9805, 916, 865, 5662, 8563, 3005, 981, 7198, 1344, 2798, 8335, 7044, 2988, 7104, 9167, 3452, 7654, 4624, 7807, 207, 3091, 8163, 7389, 3184, 870, 4709, 3158, 781, 128, 7886, 205, 2418, 232, 2550, 7946, 8573, 2259, 2870, 7794, 2038, 4124, 6036, 3978, 8031, 4270, 7490, 435, 3097, 5507, 8424, 3095, 1388, 1401, 8619, 5868, 765, 3913, 4993, 8299, 6925, 9740, 4329, 1444, 3022, 1477, 8762, 9586, 8988, 3422, 3142, 8437, 6561, 1011, 6228, 7181, 3882, 7866, 5725, 5975, 6482, 4349, 9735, 4215, 1576, 875, 7237, 167, 9016, 4128, 5528, 2790, 7461, 1794, 4788, 3787, 7694, 6400, 4351, 3495, 4786, 3566, 2941, 5847, 887, 6015, 19, 1967, 5055, 8471, 6235, 1628, 1971, 2611, 5363, 6161, 3487, 8987, 682, 9694, 3762, 8393, 9684, 2264, 7707, 8090, 2842, 2608, 5963, 573, 6688, 9502, 6638, 3987, 6886, 1045, 8864, 2164, 8470, 2979, 1263, 6945, 7457, 4716, 2371, 7072, 5798, 3320, 9229, 3248, 6271, 1458, 8464, 289, 5999, 8154, 5021, 6635, 8460, 4348, 6850, 7509, 984, 9327, 3416, 4342, 3446, 1486, 5117, 251, 2667, 1066, 2366, 8827, 825, 7720, 8357, 5510, 6131, 7785, 2234, 3870, 9867, 135, 4318, 4996, 2927, 3638, 845, 9961, 4752, 3217, 4294, 2514, 663, 9142, 6373, 9514, 7347, 3152, 3703, 9836, 466, 2948, 1780, 1915, 4264, 405, 776, 9581, 3904, 6334, 9100, 3721, 1109, 2606, 135, 8787, 7621, 5891, 2122, 6415, 4491, 4727, 4259, 82, 3635, 4054, 3571, 1542, 8494, 5582, 1257, 7890, 7942, 3645, 5035, 3146, 1433, 8626, 5254, 6141, 9119, 73, 4760, 2238, 8133, 734, 9175, 1739, 6363, 4077, 292, 8858, 4891, 4091, 3128, 208, 2360, 6843, 3239, 1982, 1561, 8683, 960, 5500, 424, 6642, 5027, 7854, 3428, 5716, 1945, 3195, 4309, 5278, 6356, 2273, 1796, 8642, 630, 311, 6744, 697, 4251, 4934, 5708, 4558, 6877, 4668, 3144, 105, 4115, 3691, 189, 789, 96, 946, 740, 2991, 103, 1218, 8810, 2416, 3169, 3384, 961, 4278, 7012, 744, 4235, 4007, 917, 8613, 6249, 531, 5744, 8425, 2881, 2689, 9028, 5200, 7902, 2774, 888, 3634, 7039, 1764, 647, 2125, 1811, 47, 145, 3498, 4244, 3333, 2830, 4422, 9892, 9157, 190, 185, 4611, 9897, 559, 6007, 9546, 3662, 2762, 5198, 7111, 6479, 4411, 4629, 3438, 1962, 9987, 7101, 9478, 6765, 7327, 9782, 353, 172, 9194, 4046, 927, 5006, 8870, 6624, 4787, 5033, 5210, 5966, 2091, 9339, 1923, 9711, 4188, 2615, 2206, 2397, 2395, 9715, 780, 4699, 7364, 5147, 6601, 4095, 2126, 1379, 3783, 5007, 1679, 3611, 4689, 3692, 1713, 9882, 2277, 6040, 514, 8368, 4482, 679, 363, 142, 4632, 269, 6190, 3394, 400, 4923, 8905, 6502, 1402, 6904, 374, 5226, 8763, 4284, 448, 2675, 7553, 4907, 8530, 1622, 89, 2076, 276, 6826, 440, 6536, 9427, 6207, 2072, 5951, 6984, 7031, 1052, 6323, 1805, 3517, 7820, 389, 121, 2167, 8010, 9098, 8824, 3277, 9645, 1496, 6939, 4508, 492, 6685, 8910, 531, 9164, 1752, 5415, 1840, 3862, 6113, 7234, 5921, 7143, 8202, 2621, 8811, 3651, 7655, 9654, 482, 787, 91, 7989, 9301, 3361, 654, 7937, 2511, 5590, 4532, 6701, 9263, 556, 5188, 130, 2923, 4524, 8201, 6119, 29, 4208, 4554, 8336, 2942, 530, 6584, 2306, 233, 7203, 9089, 9293, 50, 3606, 274, 7498, 8555, 735, 526, 6997, 4079, 998, 7432, 1806, 8531, 9958, 8066, 485, 9469, 5489, 4209, 2031, 9493, 661, 9295, 6746, 8871, 3860, 8734, 490, 5425, 1014, 3116, 272, 75, 1473, 6133, 9830, 9131, 6115, 1165, 9727, 3751, 519, 31, 6342, 9732, 6880, 6603, 6779, 9995, 7067, 2561, 804, 2715, 8926, 3983, 1830, 7032, 3585, 9006, 3708, 9818, 3288, 957, 1305, 918, 1434, 456, 9845, 689, 8350
]
caso= [caso1,caso2,caso3,caso4,caso5]

for i in range(5):
  QuickSort(caso[i],0,len(caso[i])-1)
  total = logicas + asignacion + comparacion + aritmeticas
  print("el total para el caso",i+1," fue :",total)
  print("logica:",logicas,"asignacion:", asignacion,"comparacion: ", comparacion,"aritmeticas:", aritmeticas)
  logicas,asignacion,comparacion,aritmeticas=0,0,0,0